<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Icewater&#39;s Blog</title>
  <meta name="author" content="lfq7413">
  
  <meta name="description" content="description">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Icewater&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Icewater&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Icewater&#39;s Blog</a></h1>
  <h2><a href="/">subtitle</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="https://github.com/lfq7413">GitHub</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-07-22T08:38:05.000Z"><a href="/2015/07/22/iOS开发学习笔记1/">2015-07-22</a></time>
      
      
  
    <h1 class="title"><a href="/2015/07/22/iOS开发学习笔记1/">iOS开发学习笔记1</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="0x00_概述">0x00 概述</h2><p>本文为学习 <a href="http://www.imooc.com/learn/149" target="_blank" rel="external">Swift Weather APP</a> 之后的学习笔记。主要的知识点包括：CocoaPods 的使用、Core Location 的使用、AFNetworking的使用等。</p>
<h2 id="0x01_CocoaPods_使用">0x01 CocoaPods 使用</h2><p>CocoaPods <a href="https://cocoapods.org/" target="_blank" rel="external">官方网站</a> ，安装过程可根据首页提示来进行。</p>
<ol>
<li><p>安装 CocoaPods</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem <span class="keyword">install</span> cocoapods</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入项目根目录，创建 Podfile，执行</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>pod init</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑 Podfile 文件，添加需要的库</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">platform</span> :ios, <span class="string">'8.0'</span></span><br><span class="line">use_frameworks!</span><br><span class="line">target <span class="string">'MyApp'</span> <span class="built_in">do</span></span><br><span class="line">  pod <span class="string">'AFNetworking'</span>, <span class="string">'~&gt; 2.5'</span></span><br><span class="line">  pod <span class="string">'ORStackView'</span>, <span class="string">'~&gt; 2.0'</span></span><br><span class="line">  pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.1'</span></span><br><span class="line"><span class="function"><span class="keyword">end</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装库和相应的依赖</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pod <span class="keyword">install</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>之后打开pod生成的工程文件即可</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">open</span> <span class="keyword">App</span>.xcworkspace</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="0x02_在应用中使用_Core_Location">0x02 在应用中使用 Core Location</h2><p>Core Location 为 iOS 中的定位组件，下面为使用步骤。</p>
<ol>
<li><p>引入 CoreLocation</p>
<figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"><span class="keyword">import</span> CoreLocation</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化 CLLocationManager</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> locationManager:<span class="type">CLLocationManager</span> = <span class="type">CLLocationManager</span>()</span><br><span class="line">locationManager.delegate = <span class="keyword">self</span></span><br><span class="line"><span class="comment">/**设置精度**/</span></span><br><span class="line">locationManager.desiredAccuracy = kCLLocationAccuracyBest</span><br><span class="line"><span class="comment">/**iOS8 以上可设置总是打开定位**/</span></span><br><span class="line">locationManager.requestAlwaysAuthorization()</span><br><span class="line"><span class="comment">/**开始定位**/</span></span><br><span class="line">locationManager.startUpdatingLocation()</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现 CLLocationManagerDelegate 中的指定接口</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**当获取到经纬度时会调用**/</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">locationManager</span><span class="params">(manager: CLLocationManager, didUpdateLocations locations: [AnyObject])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(location.horizontalAccuracy &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//TODO 处理获取到的经纬度</span></span><br><span class="line">        <span class="keyword">let</span> lat = location.coordinate.latitude</span><br><span class="line">        <span class="keyword">let</span> lon = location.coordinate.longitude</span><br><span class="line">        <span class="comment">/**停止定位**/</span></span><br><span class="line">        locationManager.stopUpdatingLocation()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**当定位出错时会调用**/</span></span><br><span class="line"><span class="func"><span class="keyword">func</span> <span class="title">locationManager</span><span class="params">(manager: CLLocationManager, didFailWithError error: NSError)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//TODO 处理错误信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="0x03_使用_AFNetworking">0x03 使用 AFNetworking</h2><p><a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="external">AFNetworking</a> 为 iOS/OSX 平台上的一款强大的网络开源库。</p>
<ol>
<li><p>在 Podfile 文件中加入 AFNetworking</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">pod</span> <span class="string">'AFNetworking'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在 swift 项目的桥接文件中添加</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="title">&lt;AFNetworking/AFNetworking.h&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">manager =</span> AFHTTPRequestOperationManager()</span><br><span class="line"><span class="keyword">let</span> <span class="variable">url =</span> <span class="string">"http://api.openweathermap.org/data/2.5/weather"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">params =</span> [<span class="string">"lat"</span>:lat, <span class="string">"lon"</span>:lon, <span class="string">"cnt"</span>:<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>GET请求</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">manager</span><span class="class">.GET</span>(url,</span><br><span class="line">            <span class="attribute">parameters</span>: params,</span><br><span class="line">            <span class="attribute">success</span>: &#123; (<span class="tag">operation</span><span class="pseudo">:AFHTTPRequestOperation</span>!, <span class="tag">responseObject</span><span class="pseudo">:AnyObject</span>!) <span class="tag">-</span>&gt; <span class="tag">Void</span> <span class="tag">in</span></span><br><span class="line">                <span class="comment">//TODO 处理返回结果</span></span><br><span class="line">            &#125;) &#123; (<span class="attribute">operation</span>:AFHTTPRequestOperation!, <span class="attribute">error</span>:NSError!) -&gt; Void in</span><br><span class="line">                <span class="comment">//TODO 处理错误信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="0x04_小技巧">0x04 小技巧</h2><ol>
<li><p>设置 view 背景</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let bg = <span class="function"><span class="title">UIImage</span><span class="params">(named: <span class="string">"background"</span>)</span></span></span><br><span class="line">self<span class="class">.view</span><span class="class">.backgroundColor</span> = <span class="function"><span class="title">UIColor</span><span class="params">(patternImage: bg!)</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>判断 iOS 版本号</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">Float</span><span class="params">(UIDevice.currentDevice()</span></span>.systemVersion) &gt;= <span class="number">8.0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改状态栏主题</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="func"><span class="keyword">func</span> <span class="title">preferredStatusBarStyle</span><span class="params">()</span> -&gt; <span class="title">UIStatusBarStyle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> .<span class="type">LightContent</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>原生的 JSON 解析</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jsonObject <span class="keyword">as</span>! NSDictionary</span><br><span class="line">jsonObject <span class="keyword">as</span>! NSArray</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-06T05:42:29.000Z"><a href="/2015/05/06/Github-加星项目汇总/">2015-05-06</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/06/Github-加星项目汇总/">Github 加星项目汇总</a></h1>
  

    </header>
    <div class="entry">
      
        <ul>
<li><a href="https://github.com/tobegit3hub/understand_linux_process" target="_blank" rel="external">tobegit3hub/understand_linux_process</a><blockquote>
<p>开源电子书《理解 Linux 进程》</p>
</blockquote>
</li>
<li><a href="https://github.com/futuresimple/android-floating-action-button" target="_blank" rel="external">futuresimple/android-floating-action-button</a><blockquote>
<p>增强的 Floating Action Button 实现，包含子菜单，基于<a href="https://github.com/makovkastar/FloatingActionButton" target="_blank" rel="external">makovkastar / FloatingActionButton</a>开发</p>
</blockquote>
</li>
<li><a href="https://github.com/mogujie/TeamTalk" target="_blank" rel="external">mogujie / TeamTalk</a><blockquote>
<p>蘑菇街开源的即时通信项目</p>
</blockquote>
</li>
<li><a href="https://github.com/dariubs/GoBooks" target="_blank" rel="external">dariubs / GoBooks</a><blockquote>
<p>开源 Go 语言书籍汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/makovkastar/FloatingActionButton" target="_blank" rel="external">makovkastar / FloatingActionButton</a><blockquote>
<p>Material Design : Floating Action Button 实现</p>
</blockquote>
</li>
<li><a href="https://github.com/lightSky/Awesome-MaterialDesign" target="_blank" rel="external">lightSky / Awesome-MaterialDesign</a><blockquote>
<p>Material Design 相关资源汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/dullgiulio/pingo" target="_blank" rel="external">dullgiulio / pingo</a><blockquote>
<p>Go 语言插件框架</p>
</blockquote>
</li>
<li><a href="https://github.com/duilib/duilib" target="_blank" rel="external">duilib / duilib</a><blockquote>
<p>Windows DUI 框架</p>
</blockquote>
</li>
<li><a href="https://github.com/facebook/fresco" target="_blank" rel="external">facebook / fresco</a><blockquote>
<p>Facebook 出品的 Android 图片加载库</p>
</blockquote>
</li>
<li><a href="https://github.com/phishman3579/java-algorithms-implementation" target="_blank" rel="external">phishman3579 / java-algorithms-implementation</a><blockquote>
<p>Java 实现各种数据结构与算法</p>
</blockquote>
</li>
<li><a href="https://github.com/falnatsheh/MarkdownView" target="_blank" rel="external">falnatsheh / MarkdownView</a><blockquote>
<p>Android Markdown 显示控件</p>
</blockquote>
</li>
<li><a href="https://github.com/facebook/stetho" target="_blank" rel="external">facebook / stetho</a><blockquote>
<p>Facebook 出品的 Android 应用调试库</p>
</blockquote>
</li>
<li><a href="https://github.com/saulmm/Android-Material-Examples" target="_blank" rel="external">saulmm / Android-Material-Examples</a><blockquote>
<p>Material Design 部分效果实现</p>
</blockquote>
</li>
<li><a href="https://github.com/pcqpcq/open-source-android-apps" target="_blank" rel="external">pcqpcq / open-source-android-apps</a><blockquote>
<p>开源 Android 应用汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/dkhamsing/open-source-ios-apps" target="_blank" rel="external">dkhamsing / open-source-ios-apps</a><blockquote>
<p>开源 iOS 应用汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/lgvalle/Material-Animations" target="_blank" rel="external">lgvalle / Material-Animations</a><blockquote>
<p>Material Design 中的转场动画实现</p>
</blockquote>
</li>
<li><a href="https://github.com/Yalantis/Taurus" target="_blank" rel="external">Yalantis / Taurus</a><blockquote>
<p>一个有趣的 Android 下拉刷新控件</p>
</blockquote>
</li>
<li><a href="https://github.com/hexojs/hexo" target="_blank" rel="external">hexojs / hexo</a><blockquote>
<p>静态博客框架</p>
</blockquote>
</li>
<li><a href="https://github.com/cymcsg/UltimateRecyclerView" target="_blank" rel="external">cymcsg / UltimateRecyclerView</a><blockquote>
<p>终极 RecyclerView：下拉刷新、拖拽、加载更多、动画等</p>
</blockquote>
</li>
<li><a href="https://github.com/sunng87/awesome-leancloud" target="_blank" rel="external">sunng87 / awesome-leancloud</a><blockquote>
<p>LeanCloud 开源生态系统聚合</p>
</blockquote>
</li>
<li><a href="https://github.com/Rano1/Interactive-animation" target="_blank" rel="external">Rano1 / Interactive-animation</a><blockquote>
<p>Android 交互动画和视觉效果开源库汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/JayFang1993/ScanBook" target="_blank" rel="external">JayFang1993 / ScanBook</a><blockquote>
<p>开源 Android 应用：扫扫图书</p>
</blockquote>
</li>
<li><a href="https://github.com/android-cn/android-discuss" target="_blank" rel="external">android-cn / android-discuss</a><blockquote>
<p>Android 问题交流讨论坛</p>
</blockquote>
</li>
<li><a href="https://github.com/hyper-carrot/goc2p" target="_blank" rel="external">hyper-carrot / goc2p</a><blockquote>
<p>《Go并发编程实战》随书源码</p>
</blockquote>
</li>
<li><a href="https://github.com/Unknwon/go-fundamental-programming" target="_blank" rel="external">Unknwon / go-fundamental-programming</a><blockquote>
<p>《Go编程基础》 Go 语言的视频语音教程</p>
</blockquote>
</li>
<li><a href="https://github.com/Unknwon/the-way-to-go_ZH_CN" target="_blank" rel="external">Unknwon / the-way-to-go_ZH_CN</a><blockquote>
<p>《Go入门指南》</p>
</blockquote>
</li>
<li><a href="https://github.com/gogits/gogs" target="_blank" rel="external">gogits / gogs</a><blockquote>
<p>Go 语言实现的 Git Service</p>
</blockquote>
</li>
<li><a href="https://github.com/rg3/youtube-dl" target="_blank" rel="external">rg3 / youtube-dl</a><blockquote>
<p>Python 实现的视频下载工具，支持YouTube.com等几十个视频网站</p>
</blockquote>
</li>
<li><a href="https://github.com/kesenhoo/android-training-course-in-chinese" target="_blank" rel="external">kesenhoo / android-training-course-in-chinese</a><blockquote>
<p>Android 官方培训课程中文版</p>
</blockquote>
</li>
<li><a href="https://github.com/zmap/zmap" target="_blank" rel="external">zmap / zmap</a><blockquote>
<p>速度最快的网络扫描器，5分钟扫遍 IPv4</p>
</blockquote>
</li>
<li><a href="https://github.com/rovo89/Xposed" target="_blank" rel="external">rovo89 / Xposed</a><blockquote>
<p>Android 系统插件框架</p>
</blockquote>
</li>
<li><a href="https://github.com/sevenler/Uninstall_Statics" target="_blank" rel="external">sevenler / Uninstall_Statics</a><blockquote>
<p>Android 应用监听自身被卸载</p>
</blockquote>
</li>
<li><a href="https://github.com/Jason-lee-c/CocosWidget" target="_blank" rel="external">Jason-lee-c / CocosWidget</a><blockquote>
<p>Cocos2D-x 实现各种界面控件</p>
</blockquote>
</li>
<li><a href="https://github.com/magicshui/leancloud" target="_blank" rel="external">magicshui / leancloud</a><blockquote>
<p>LeanCloud Go 语言版的 SDK</p>
</blockquote>
</li>
<li><a href="https://github.com/zx9597446/go-leancloud" target="_blank" rel="external">zx9597446 / go-leancloud</a><blockquote>
<p>LeanCloud Go 语言版的 SDK</p>
</blockquote>
</li>
<li><a href="https://github.com/konifar/android-material-design-icon-generator-plugin" target="_blank" rel="external">konifar / android-material-design-icon-generator-plugin</a><blockquote>
<p>Material Design 图标生成插件，适用于 Android Studio</p>
</blockquote>
</li>
<li><a href="https://github.com/google/material-design-icons" target="_blank" rel="external">google / material-design-icons</a><blockquote>
<p>Google 出品的 Material Design 图标库</p>
</blockquote>
</li>
<li><a href="https://github.com/orhanobut/hawk" target="_blank" rel="external">orhanobut / hawk</a><blockquote>
<p>安全简单的 Key-Value 库，适用于 Android</p>
</blockquote>
</li>
<li><a href="https://github.com/cesards/CropImageView" target="_blank" rel="external">cesards / CropImageView</a><blockquote>
<p>从任意边放大图片覆盖 Image</p>
</blockquote>
</li>
<li><a href="https://github.com/jfrazelle/mac-dev-setup" target="_blank" rel="external">jfrazelle / mac-dev-setup</a><blockquote>
<p>Mac OS X 上各种开发环境搭建</p>
</blockquote>
</li>
<li><a href="https://github.com/LitePalFramework/LitePal" target="_blank" rel="external">LitePalFramework / LitePal</a><blockquote>
<p>郭霖出品的 Android 数据库操作框架</p>
</blockquote>
</li>
<li><a href="https://github.com/binux/pyspider" target="_blank" rel="external">binux / pyspider</a><blockquote>
<p>Python 实现的网络爬虫</p>
</blockquote>
</li>
<li><a href="https://github.com/ZieIony/Carbon" target="_blank" rel="external">ZieIony / Carbon</a><blockquote>
<p>适用于 Android 2.1+ 的 Material Design 控件库</p>
</blockquote>
</li>
<li><a href="https://github.com/navasmdc/MaterialDesignLibrary" target="_blank" rel="external">navasmdc / MaterialDesignLibrary</a><blockquote>
<p>适用于 Android 2.2+ 的 Material Design 控件库</p>
</blockquote>
</li>
<li><a href="https://github.com/neokree/MaterialNavigationDrawer" target="_blank" rel="external">neokree / MaterialNavigationDrawer</a><blockquote>
<p>Material Design 导航抽屉框架</p>
</blockquote>
</li>
<li><a href="https://github.com/JoanZapata/android-iconify" target="_blank" rel="external">JoanZapata / android-iconify</a><blockquote>
<p>给 TextView、Button、菜单项设置图片资源</p>
</blockquote>
</li>
<li><a href="https://github.com/wasabeef/awesome-android-ui" target="_blank" rel="external">wasabeef / awesome-android-ui</a><blockquote>
<p>Android UI/UX 开源库汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/kymjs/KJFrameForAndroid" target="_blank" rel="external">kymjs / KJFrameForAndroid</a><blockquote>
<p>Android 开发框架，包含 MVC、Bitmap、Http、数据库、插件框架等模块</p>
</blockquote>
</li>
<li><a href="https://github.com/kymjs/CJFrameForAndroid" target="_blank" rel="external">kymjs / CJFrameForAndroid</a><blockquote>
<p>Android 插件化开发框架</p>
</blockquote>
</li>
<li><a href="https://github.com/houkx/android-pluginmgr" target="_blank" rel="external">houkx / android-pluginmgr</a><blockquote>
<p>Android 插件框架</p>
</blockquote>
</li>
<li><a href="https://github.com/yangyangwithgnu/hardseed" target="_blank" rel="external">yangyangwithgnu / hardseed</a><blockquote>
<p>图片种子爬虫</p>
</blockquote>
</li>
<li><a href="https://github.com/felixhageloh/uebersicht" target="_blank" rel="external">felixhageloh / uebersicht</a><blockquote>
<p>Mac 上的桌面美化工具</p>
</blockquote>
</li>
<li><a href="https://github.com/ksoichiro/Android-ObservableScrollView" target="_blank" rel="external">ksoichiro / Android-ObservableScrollView</a><blockquote>
<p>神库：监控控件的滚动事件，并简单的与 Toolbar 进行交互</p>
</blockquote>
</li>
<li><a href="https://github.com/MichaelEvans/ColorArt" target="_blank" rel="external">MichaelEvans / ColorArt</a><blockquote>
<p>根据指定图片自动计算出合适的背景色及前景色</p>
</blockquote>
</li>
<li><a href="https://github.com/woozzu/IndexableListView" target="_blank" rel="external">woozzu / IndexableListView</a><blockquote>
<p>带字母索引的 ListView</p>
</blockquote>
</li>
<li><a href="https://github.com/aosp-exchange-group/share" target="_blank" rel="external">aosp-exchange-group / share</a><blockquote>
<p>Android 开源交流 QQ 群分享汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/twall/jna" target="_blank" rel="external">twall / jna</a><blockquote>
<p>方便的 Java native 调用库</p>
</blockquote>
</li>
<li><a href="https://github.com/GavinCT/AndroidMultiChannelBuildTool" target="_blank" rel="external">GavinCT / AndroidMultiChannelBuildTool</a><blockquote>
<p>Android 多渠道打包工具</p>
</blockquote>
</li>
<li><a href="https://github.com/romannurik/Android-SwipeToDismiss" target="_blank" rel="external">romannurik / Android-SwipeToDismiss</a><blockquote>
<p>Android 滑动删除库</p>
</blockquote>
</li>
<li><a href="https://github.com/rustcc/rust-by-example" target="_blank" rel="external">rustcc / rust-by-example</a><blockquote>
<p>通过例子学习 Rust 语言</p>
</blockquote>
</li>
<li><a href="https://github.com/mcxiaoke/gradle-packer-plugin" target="_blank" rel="external">mcxiaoke / gradle-packer-plugin</a><blockquote>
<p>Android 多渠道打包工具 Gradle 插件</p>
</blockquote>
</li>
<li><a href="https://github.com/commonsguy/cw-omnibus" target="_blank" rel="external">commonsguy / cw-omnibus</a><blockquote>
<p>图书 The Busy Coder’s Guide to Android Development 随书源码</p>
</blockquote>
</li>
<li><a href="https://github.com/daimajia/bleed-baidu-white" target="_blank" rel="external">daimajia / bleed-baidu-white</a><blockquote>
<p>榨干百度网盘计划</p>
</blockquote>
</li>
<li><a href="https://github.com/google/iosched" target="_blank" rel="external">google / iosched</a><blockquote>
<p>Google I/O 2014 Android 应用源码</p>
</blockquote>
</li>
<li><a href="https://github.com/gopherjs/gopherjs" target="_blank" rel="external">gopherjs / gopherjs</a><blockquote>
<p>把 Go 语言编译成 JavaScript，使 Go 可以运行在浏览器中</p>
</blockquote>
</li>
<li><a href="https://github.com/sequelize/sequelize" target="_blank" rel="external">sequelize / sequelize</a><blockquote>
<p>适用于 Node.js &amp; io.js 的 ORM 库</p>
</blockquote>
</li>
<li><a href="https://github.com/drakeet/MaterialDialog" target="_blank" rel="external">drakeet / MaterialDialog</a><blockquote>
<p>Material Design 风格的对话框</p>
</blockquote>
</li>
<li><a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="external">JakeWharton / NineOldAndroids</a><blockquote>
<p>将 Android 3.0 上的动画 API 应用到 Android 1.0+</p>
</blockquote>
</li>
<li><a href="https://github.com/square/otto" target="_blank" rel="external">square / otto</a><blockquote>
<p>Square 出品的 Android 事件总线库</p>
</blockquote>
</li>
<li><a href="https://github.com/buaazp/zimg" target="_blank" rel="external">buaazp / zimg</a><blockquote>
<p>C 语言编写的图片存储及处理系统</p>
</blockquote>
</li>
<li><a href="https://github.com/yeasy/docker_practice" target="_blank" rel="external">yeasy / docker_practice</a><blockquote>
<p>Docker —— 从入门到实践</p>
</blockquote>
</li>
<li><a href="https://github.com/ikew0ng/SwipeBackLayout" target="_blank" rel="external">ikew0ng / SwipeBackLayout</a><blockquote>
<p>Android 滑动返回库</p>
</blockquote>
</li>
<li><a href="https://github.com/tobegit3hub/mycomputer" target="_blank" rel="external">tobegit3hub / mycomputer</a><blockquote>
<p>一个开源网站 Mvc + jquerY + doCker + beegO + Mysql + bootstraP + linUx + resTful + bowEr + angulaR</p>
</blockquote>
</li>
<li><a href="https://github.com/hyper-carrot/go_command_tutorial" target="_blank" rel="external">hyper-carrot / go_command_tutorial</a><blockquote>
<p>Go 命令教程</p>
</blockquote>
</li>
<li><a href="https://github.com/docker/docker" target="_blank" rel="external">docker / docker</a><blockquote>
<p>开源的容器引擎</p>
</blockquote>
</li>
<li><a href="https://github.com/zxing/zxing" target="_blank" rel="external">zxing / zxing</a><blockquote>
<p>二维码识别项目</p>
</blockquote>
</li>
<li><a href="https://github.com/greenrobot/EventBus" target="_blank" rel="external">greenrobot / EventBus</a><blockquote>
<p>Android 事件总线</p>
</blockquote>
</li>
<li><a href="https://github.com/nostra13/Android-Universal-Image-Loader" target="_blank" rel="external">nostra13 / Android-Universal-Image-Loader</a><blockquote>
<p>强大的 Android 图片加载库</p>
</blockquote>
</li>
<li><a href="https://github.com/square/okhttp" target="_blank" rel="external">square / okhttp</a><blockquote>
<p>Square 出品的网络连接库</p>
</blockquote>
</li>
<li><a href="https://github.com/cesards/AndroidElementals" target="_blank" rel="external">cesards / AndroidElementals</a><blockquote>
<p>Android 开源库、示例、工具、开源应用汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/android-cn/android-open-project-demo" target="_blank" rel="external">android-cn / android-open-project-demo</a><blockquote>
<p>Android 开源项目 Demo</p>
</blockquote>
</li>
<li><a href="https://github.com/android-cn/android-open-project-analysis" target="_blank" rel="external">android-cn / android-open-project-analysis</a><blockquote>
<p>Android 开源项目源码解析</p>
</blockquote>
</li>
<li><a href="https://github.com/shadowsocks/shadowsocks" target="_blank" rel="external">shadowsocks / shadowsocks</a><blockquote>
<p>A fast tunnel proxy that helps you bypass firewalls</p>
</blockquote>
</li>
<li><a href="https://github.com/rose1988c/Caoliu.plug" target="_blank" rel="external">rose1988c / Caoliu.plug</a><blockquote>
<p>t66y 论坛增强插件</p>
</blockquote>
</li>
<li><a href="https://github.com/astaxie/build-web-application-with-golang" target="_blank" rel="external">astaxie / build-web-application-with-golang</a><blockquote>
<p>开源书籍：Go Web 编程</p>
</blockquote>
</li>
<li><a href="https://github.com/Trinea/android-open-project" target="_blank" rel="external">Trinea / android-open-project</a><blockquote>
<p>Android开源项目分类汇总</p>
</blockquote>
</li>
<li><a href="https://github.com/comeforu2012/truth" target="_blank" rel="external">comeforu2012 / truth</a><blockquote>
<p>Chrome + GoAgent</p>
</blockquote>
</li>
<li><a href="https://github.com/astaxie/beego" target="_blank" rel="external">astaxie / beego</a><blockquote>
<p>Go 语言编写的 web 开发框架</p>
</blockquote>
</li>
<li><a href="https://github.com/numbbbbb/the-swift-programming-language-in-chinese" target="_blank" rel="external">numbbbbb / the-swift-programming-language-in-chinese</a><blockquote>
<p>Apple 官方 Swift 教程中文版</p>
</blockquote>
</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-24T13:03:14.000Z"><a href="/2015/04/24/Material-Design-实践：将导航抽屉显示到-ActionBar-与-statusbar-之间/">2015-04-24</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/24/Material-Design-实践：将导航抽屉显示到-ActionBar-与-statusbar-之间/">Material Design 实践：将导航抽屉显示到 ActionBar 与 statusbar 之间</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="0x00">0x00</h2><p>在 Material Design 中，导航抽屉要显示到状态栏以下，ActionBar 或者 ToolBar 以上，状态栏呈现半透明状，这种效果在最新的 Google 应用中大量应用。实际的显示效果如下图所示：</p>
<p><img src="http://ww2.sinaimg.cn/large/6c02de7dgw1ergyi22gc2j20a00a0t9h.jpg" alt=""></p>
<p>在 Eclipse 下使用 ADT 生成的导航抽屉应用模板中，还是早先的 Android Design ，导航抽屉会显示在状态栏与 ActionBar 之下。本文将在该模板的基础上改进，参考了 <a href="http://stackoverflow.com/questions/26440879/how-do-i-use-drawerlayout-to-display-over-the-actionbar-toolbar-and-under-the-st/26440880" target="_blank" rel="external">stackoverflow</a> 上得票最高的答案。</p>
<blockquote>
<p>新建空项目，按照以下步骤也是可以做到的。</p>
</blockquote>
<h2 id="0x01_原理">0x01 原理</h2><p>要实现上述的效果，需要做到以下几点：</p>
<ol>
<li>状态栏需要变成灰色的半透明状</li>
<li>导航抽屉要延伸到状态栏以下</li>
<li>导航抽屉要覆盖在 ActionBar 上面</li>
<li>整体页面要延伸到状态栏以下</li>
<li>要能设置半透明状态后面的背景颜色</li>
</ol>
<h2 id="0x02_操作">0x02 操作</h2><ol>
<li>使用 Toolbar 来替代默认的 ActionBar ，这样可以使其嵌入到页面的视图层级中，导航抽屉就可以覆盖到 ActionBar 上</li>
<li>设置页面根布局 DrawerLayout 的 fitsSystemWindows 为 true ，则可使其延伸到状态栏下面</li>
<li>设置导航抽屉布局的 fitsSystemWindows 为 true ，使其延伸到状态栏下面</li>
<li>在主题中设置状态栏颜色 statusBarColor 为半透明</li>
<li>在主题中设置 windowDrawsSystemBarBackgrounds 为 true ，之后可在代码中设置状态栏的背景</li>
</ol>
<blockquote>
<p>我们要用到最新的 Appcompat 兼容包。</p>
</blockquote>
<h2 id="0x03_布局文件">0x03 布局文件</h2><p>布局文件及注释参考如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注意设置 fitSystemWindows --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">android.support.v4.widget.DrawerLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span><br><span class="line">    <span class="attribute">android:id</span>=<span class="value">"@+id/my_drawer_layout"</span></span><br><span class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">    <span class="attribute">android:fitsSystemWindows</span>=<span class="value">"true"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span> &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 这里使用 Toolbar ，抽屉可显示到 ActionBar 之上 --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="title">android.support.v7.widget.Toolbar</span></span><br><span class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/my_awesome_toolbar"</span></span><br><span class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></span><br><span class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></span><br><span class="line">            <span class="attribute">android:background</span>=<span class="value">"?attr/colorPrimary"</span></span><br><span class="line">            <span class="attribute">android:minHeight</span>=<span class="value">"?attr/actionBarSize"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span><br><span class="line">                 导航抽屉，这里可以使任何 view, 设置 fitSystemWindows=true</span><br><span class="line">         		其将会延伸到 status bar 之下</span><br><span class="line">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span><br><span class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"304dp"</span></span><br><span class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></span><br><span class="line">        <span class="attribute">android:layout_gravity</span>=<span class="value">"left|start"</span></span><br><span class="line">        <span class="attribute">android:fitsSystemWindows</span>=<span class="value">"true"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="title">android.support.v4.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="0x04_Activity/Fragment_中的代码">0x04 Activity/Fragment 中的代码</h2><p>在 Activity/Fragment 中指定 toolbar 来作为 ActionBar ，并在根布局上设置状态栏后面的背景颜色：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundled savedInstanceState)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 Toolbar 设置为 ActionBar</span></span><br><span class="line">	Toolbar toolbar = (Toolbar) findViewById(R.id.my_awesome_toolbar);</span><br><span class="line">	setSupportActionBar(toolbar);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置状态栏背景颜色，只会在 Lollipop 上生效</span></span><br><span class="line">	DrawerLayout drawerLayout = (DrawerLayout) findViewById(R.id.my_drawer_layout);</span><br><span class="line">	drawerLayout.setStatusBarBackgroundColor(<span class="number">0xFFF44336</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x05_修改主题">0x05 修改主题</h2><p>因为以下几个属性只在v21之后的系统版本中存在，所以需要修改 values-v21/themes.xml 这个主题文件：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=<span class="string">"Theme.MyApp"</span> parent=<span class="string">"Theme.AppCompat.Light.NoActionBar"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;item name=<span class="string">"android:windowDrawsSystemBarBackgrounds"</span>&gt;true&lt;/item&gt;</span><br><span class="line">    &lt;item name=<span class="string">"android:statusBarColor"</span>&gt;<span class="hexcolor">#100000</span>00&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>父主题需要选择 NoActionBar 这一类的，因为我们已经使用 ToolBar 作为 ActionBar 了</li>
<li>设置 windowDrawsSystemBarBackgrounds=true 允许修改背景</li>
<li>设置 statusBarColor 标题栏颜色为半透明，透明值可自定义</li>
<li>不需要再设置 windowTranslucentStatus 属性，此系统定义的半透明不可控，使用 statusBarColor 即可</li>
</ul>
<h2 id="0x06_如果抽屉视图为_fragment">0x06 如果抽屉视图为 fragment</h2><p>如果使用 fragment 作为抽屉视图，那么需要在 onCreateView 中再次设置 fitsSystemWindows</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater,</span><br><span class="line">                 ViewGroup container,</span><br><span class="line">                 Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">	View mDrawerListView = inflater.inflate(R.layout.fragment_navigation_drawer, container, <span class="keyword">false</span>);</span><br><span class="line">	mDrawerListView.setFitsSystemWindows(<span class="keyword">true</span>);</span><br><span class="line">	<span class="keyword">return</span> mDrawerListView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x07_总结">0x07 总结</h2><p>通过以上几步，即可实现本文开头提到的效果。但是有一点不足：抽屉中的元素均排在状态栏下面。可设置 layout_marginTop 为负值，大小为状态栏的高度，使元素与状态栏重叠显示。在<a href="http://soloho.cc/blog/how-do-i-use-drawerlayout-to-display-over-the-actionbar-or-toolbar-and-under-the-status-bar?utm_source=tuicool" target="_blank" rel="external">这篇文章</a>中使用到了 <a href="http://stackoverflow.com/questions/26440879/how-do-i-use-drawerlayout-to-display-over-the-actionbar-toolbar-and-under-the-st/26440880" target="_blank" rel="external">stackoverflow</a> 上得票第二高答案中的方法，使用开源库来自动计算状态栏高度，并设置位移。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-20T05:23:34.000Z"><a href="/2015/04/20/Android-蓝牙-spp-开发汇总/">2015-04-20</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/20/Android-蓝牙-spp-开发汇总/">Android 蓝牙 spp 开发汇总</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="0x00">0x00</h2><p>本文记录蓝牙 spp 开发的流程及遇到的问题。包括设备扫描、配对、连接、数据交互</p>
<blockquote>
<p><strong>蓝牙权限：</strong></p>
</blockquote>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:<span class="property">name</span>=<span class="string">"android.permission.BLUETOOTH"</span> /&gt;</span><br><span class="line">&lt;uses-permission android:<span class="property">name</span>=<span class="string">"android.permission.BLUETOOTH_ADMIN"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h2 id="0x01_设备扫描">0x01 设备扫描</h2><ul>
<li>获取蓝牙适配器</li>
</ul>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BluetoothAdapter.getDefaultAdapter<span class="comment">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>检测蓝牙是否打开</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BluetoothAdapter.<span class="function"><span class="title">isEnabled</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>打开蓝牙设置界面</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);</span><br><span class="line">startActivityForResult(intent, Activity.REQUEST_ENABLE);</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (requestCode == REQUEST_ENABLE) &#123;</span><br><span class="line">		<span class="keyword">if</span> (resultCode == RESULT_OK) &#123;</span><br><span class="line">			<span class="comment">//TODO 接收蓝牙打开的消息</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>开启扫描</li>
</ul>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BluetoothAdapter.startDiscovery<span class="comment">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>接收扫描结果</li>
</ul>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">IntentFilter intentFilter <span class="subst">=</span> <span class="literal">new</span> IntentFilter();</span><br><span class="line">intentFilter<span class="built_in">.</span>addAction(BluetoothDevice<span class="built_in">.</span>ACTION_FOUND);</span><br><span class="line">intentFilter<span class="built_in">.</span>addAction(BluetoothAdapter<span class="built_in">.</span>ACTION_DISCOVERY_FINISHED);</span><br><span class="line">registerReceiver(<span class="literal">new</span> ScanBluetoothReceiver(), intentFilter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="literal">void</span> onReceive(Context context, final Intent intent) &#123;</span><br><span class="line">	<span class="built_in">String</span> action <span class="subst">=</span> intent<span class="built_in">.</span>getAction();</span><br><span class="line">	BluetoothDevice bluetoothDevice <span class="subst">=</span> intent<span class="built_in">.</span>getParcelableExtra(BluetoothDevice<span class="built_in">.</span>EXTRA_DEVICE);</span><br><span class="line">	<span class="keyword">if</span> (action<span class="built_in">.</span><span class="keyword">equals</span>(BluetoothDevice<span class="built_in">.</span>ACTION_FOUND)) &#123;</span><br><span class="line">		<span class="comment">//TODO 扫描到设备 bluetoothDevice</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (action<span class="built_in">.</span><span class="keyword">equals</span>(BluetoothAdapter<span class="built_in">.</span>ACTION_DISCOVERY_FINISHED)) &#123;</span><br><span class="line">		<span class="comment">//TODO 扫描结束</span></span><br><span class="line">		<span class="comment">//TODO 取消注册该接收器 unregisterReceiver(this);</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x02_配对">0x02 配对</h2><ul>
<li>在与设备进行交互前停止设备扫描，设备扫描将影响设备的连接速度</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BluetoothAdapter</span>.cancelDiscovery<span class="literal">()</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>设备配对</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="type">BluetoothDevice</span>.getBondState<span class="literal">()</span> != <span class="type">BluetoothDevice</span>.<span class="type">BOND_BONDED</span>) &#123;</span><br><span class="line">	<span class="type">BluetoothDevice</span>.createBond<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>接受设备配对结果</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">IntentFilter intentFilter = <span class="keyword">new</span> IntentFilter();</span><br><span class="line">intentFilter.addAction(BluetoothDevice.ACTION_BOND_STATE_CHANGED);</span><br><span class="line">registerReceiver(<span class="keyword">new</span> PairStateChangeReceiver(), intentFilter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (intent.getAction().equals(BluetoothDevice.ACTION_BOND_STATE_CHANGED)) &#123;</span><br><span class="line">		n++;</span><br><span class="line">		device = BluetoothAdapter.getDefaultAdapter().getRemoteDevice(device.getAddress());</span><br><span class="line">		<span class="keyword">if</span>(device.getBondState() != BluetoothDevice.BOND_BONDED)&#123;</span><br><span class="line">			<span class="keyword">if</span>(n&gt;<span class="number">1</span>)&#123;</span><br><span class="line">				n = <span class="number">0</span>;</span><br><span class="line">				<span class="comment">//TODO 一般会接收到两次配对状态改变的广播，</span></span><br><span class="line">				<span class="comment">//TODO 当失败两次时则表示配对失败。</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//TODO 配对成功之后可选择继续连接设备</span></span><br><span class="line">		<span class="comment">//TODO 配对成功之后取消注册 unregisterReceiver(this);</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x03_连接">0x03 连接</h2><ul>
<li>设备连接，使用通用的 SPP UUID 。</li>
</ul>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BluetoothSocket <span class="variable">temp =</span> <span class="constant">null</span>; //TODO 使用中间变量赋值</span><br><span class="line">BluetoothSocket <span class="variable">mSocket =</span> <span class="constant">null</span>;</span><br><span class="line">String <span class="variable">uuid =</span> <span class="string">"00001101-0000-1000-8000-00805F9B34FB"</span>;</span><br><span class="line">UUID <span class="variable">mUUID =</span> UUID.fromString(uuid);</span><br><span class="line"><span class="variable">temp =</span> device.createInsecureRfcommSocketToServiceRecord(mUUID);</span><br><span class="line"><span class="variable">mSocket =</span> temp;</span><br><span class="line">mSocket.connect();</span><br></pre></td></tr></table></figure>
<h2 id="0x04_数据交互">0x04 数据交互</h2><ul>
<li>写入数据</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BufferedOutputStream <span class="keyword">out</span> = <span class="keyword">new</span> BufferedOutputStream(connection.getOutputStream());</span><br><span class="line"><span class="keyword">out</span>.<span class="keyword">write</span>(data);</span><br><span class="line"><span class="keyword">out</span>.flush();</span><br></pre></td></tr></table></figure>
<ul>
<li>读取数据</li>
</ul>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">InputStream</span> input = connection.getInputStream<span class="literal">()</span>;</span><br><span class="line"><span class="built_in">int</span> i;</span><br><span class="line"><span class="keyword">if</span>(input.available<span class="literal">()</span> != <span class="number">0</span>)&#123;</span><br><span class="line">	i = input.read<span class="literal">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x05_总结">0x05 总结</h2><p><strong>需要注意的问题有以下几点：</strong></p>
<ul>
<li>连接设备前务必关闭设备扫描，设备发现消耗很大，会影响连接速度；</li>
<li>配对时，会立即发出状态改变广播，配对结束会再次发送；</li>
<li>在 SPP 开发时，使用通用的 UUID ；</li>
<li>在读取数据时可配合使用 <code>input.available()</code> 达到设置超时的目的。</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-03-14T09:26:12.000Z"><a href="/2015/03/14/hello-world/">2015-03-14</a></time>
      
      
  
    <h1 class="title"><a href="/2015/03/14/hello-world/">Hello</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Hello_world!">Hello world!</h1><p><img src="http://ww1.sinaimg.cn/large/6c02de7djw1eq5mcc1bpuj21kw15iwlw.jpg" alt=""></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Android/">Android</a><small>2</small></li>
  
    <li><a href="/categories/Github/">Github</a><small>1</small></li>
  
    <li><a href="/categories/iOS/">iOS</a><small>1</small></li>
  
    <li><a href="/categories/other/">other</a><small>1</small></li>
  
  </ul>
</div>


  

  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2015/07/22/iOS开发学习笔记1/">iOS开发学习笔记1</a>
      </li>
    
      <li>
        <a href="/2015/05/06/Github-加星项目汇总/">Github 加星项目汇总</a>
      </li>
    
      <li>
        <a href="/2015/04/24/Material-Design-实践：将导航抽屉显示到-ActionBar-与-statusbar-之间/">Material Design 实践：将导航抽屉显示到 ActionBar 与 statusbar 之间</a>
      </li>
    
      <li>
        <a href="/2015/04/20/Android-蓝牙-spp-开发汇总/">Android 蓝牙 spp 开发汇总</a>
      </li>
    
      <li>
        <a href="/2015/03/14/hello-world/">Hello</a>
      </li>
    
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 lfq7413
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




</body>
</html>